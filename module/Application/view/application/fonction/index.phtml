<?php

use Application\Entity\Db\Fonction;
use Application\Entity\Db\Source;

/**
 * @var Fonction[] $fonctions
 */

$this->headTitle('Index des fonctions');

?>

<h1 class="page-header">
    Index des fonctions
</h1>

<div class="main">

    <h2>
        Fonctions
        <span class="badge">
            <?php echo count($fonctions); ?>
        </span>
    </h2>

    <table class="table table-condensed">
        <thead>
            <tr>
                <th> Id </th>
                <th> Parent </th>
                <th> Code </th>
                <th> Niveau </th>
                <th> Libell√©s </th>
            </tr>
        </thead>
        <tbody>
            <?php foreach($fonctions as $fonction) : ?>
                <tr>
                    <td> <?php echo $fonction->getId(); ?> </td>
                    <td> <?php echo ($fonction !== $fonction->getParent())?$fonction->getParent()->getId():""; ?> </td>
                    <td> <?php echo $fonction->getCode(); ?> </td>
                    <td> <?php echo $fonction->getNiveau(); ?> </td>
                    <td>
                        <ul>
                        <?php foreach($fonction->getLibelles() as $libelle) : ?>
                            <li>
                                <span class="badge" <?php if ($libelle->getDefaut() === 'O') echo 'style="background-color:green;"'; ?> >
                                    <?php echo $libelle->getGenre(); ?>
                                </span>
                                <?php echo $libelle->getLibelle(); ?>
                            </li>
                        <?php endforeach; ?>
                        </ul>
                    </td>
                </tr>
            <?php endforeach; ?>
        </tbody>
    </table>
</div>


<script>
    $(function() {
        $("body").on("modification", function (event) {
            event.div.modal('hide');
            window.location.reload();
        });
    });
</script>

