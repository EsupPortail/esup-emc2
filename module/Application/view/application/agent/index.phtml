<?php

/**
 * @var Agent[] $agents
 */

use Application\Entity\Db\Agent;
use Application\Provider\Privilege\AgentPrivileges;


$canAfficher = $this->isAllowed(AgentPrivileges::getResourceId(AgentPrivileges::AFFICHER));
$canAjouter  = $this->isAllowed(AgentPrivileges::getResourceId(AgentPrivileges::AJOUTER));
$canModifier = $this->isAllowed(AgentPrivileges::getResourceId(AgentPrivileges::EDITER));
$canEffacer  = $this->isAllowed(AgentPrivileges::getResourceId(AgentPrivileges::EFFACER));
?>



<h1>
    Index des affectations
    <span class="badge">
           <?php echo count($agents); ?>
       </span>
</h1>


<div class="main">

    <?php if($canAjouter) : ?>
        <a
                class="btn btn-primary action ajax-modal"
                href="<?php echo $this->url('agent/ajouter', [], [], true); ?>"
                data-event="modification"
        >
            <i class="fas fa-plus"></i>
            Ajouter un agent
        </a>
    <?php endif; ?>

    <br/>

    <?php if (count($agents) > 0) : ?>
        <table class="table table-condensed">
            <thead>
            <tr>
                <th> Numero de poste </th>
                <th> Dénomination </th>
                <th> Corps </th>
                <th class="action"> Action </th>
            </tr>
            </thead>
            <tbody>
            <?php foreach ($agents as $agent) : ?>
                <tr>
                    <td> <?php echo $agent->getNumeroPoste(); ?> </td>
                    <td> <?php echo $agent->getPrenom(); ?> <?php echo $agent->getNom(); ?></td>
                    <td> <?php echo $agent->getCorps(); ?></td>
                    <td>
                        <?php if ($canAfficher) : ?>
                            <a href="<?php echo $this->url('agent/afficher', ['id' => $agent->getId()], [], true); ?>"
                            >
                                <i class="fas fa-eye"        title="Afficher l'agent"></i>
                            </a>
                        <?php endif; ?>
                        <?php if ($canModifier) : ?>
                            <a href="<?php echo $this->url('agent/modifier', ['id' => $agent->getId()], [], true); ?>"
                            >
                                <i class="fas fa-pencil-alt" title="Éditer l'agent"></i>
                            </a>
                        <?php endif; ?>
                        <?php if ($canEffacer) : ?>
                            <a href="<?php echo $this->url('agent/supprimer', ['id' => $agent->getId()], [], true); ?>"
                            >
                                <i class="fas fa-trash-alt"  title="Supprimer l'agent"></i>
                            </a>
                        <?php endif; ?>
                    </td>
                </tr>
            <?php endforeach; ?>
            </tbody>
        </table>
    <?php endif; ?>

</div>

