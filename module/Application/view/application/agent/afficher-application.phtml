<?php

/**
 * @see AgentController::afficherApplicationAction()
 * @var ApplicationElement $applicationElement
 * @var Agent $agent
 */

use Application\Entity\Db\Agent;
use Application\Entity\Db\ApplicationElement;

$type = null;
$annee = null;
if ($applicationElement->getCommentaire() !== null) {
    $split = explode(" - ", $applicationElement->getCommentaire());
    $type = $split[1];
    $annee = $split[0];
}
?>

<div class="row">
    <div class="col-md-6">
        <dl>
            <dt> Agent </dt>
            <dd> <?php echo $agent->getDenomination(); ?></dd>
            <dt> Application </dt>
            <dd> <?php echo $applicationElement->getApplication()->getLibelle(); ?></dd>
            <dt> Type de formation </dt>
            <dd> <?php echo ($type)?:"Non renseigné"; ?></dd>
            <dt> Année de formation </dt>
            <dd> <?php echo ($annee)?:"Non renseignée"; ?></dd>
            <dt> Validation </dt>
            <dd>
                <?php if ($applicationElement->getValidation() === null) : ?>
                    Aucune validation
                <?php else: ?>
                    <?php $validation = $applicationElement->getValidation(); ?>
                    <?php if ($validation->getValeur() === null) : ?>
                        <span
                            style="color:darkgreen;"
                            title=" Par <?php echo $validation->getHistoModificateur()->getDisplayName(); ?> le <?php echo $validation->getHistoModification()->format("d/m/Y"); ?>">
                                    <span class="icon ok"></span>
                                    Validée
                                </span>
                    <?php else: ?>
                    <span
                        style="color:darkred;"
                        title=" Par <?php echo $validation->getHistoModificateur()->getDisplayName(); ?> le <?php echo $validation->getHistoModification()->format("d/m/Y"); ?>">
                                    <span class="icon ko"></span>
                                Refusée
                    <?php endif; ?>
                <?php endif; ?>
            </dd>
        </dl>
    </div>
    <div class="col-md-6">
        <dl>
            <dt> Dernière modification </dt>
            <dd>
                <?php echo $applicationElement->getHistoModification()->format('d/m/Y à H:i:s'); ?>
                <br/>
                <?php echo $applicationElement->getHistoModificateur()->getDisplayName(); ?>
            </dd>
        </dl>

        <?php if ($applicationElement->estHistorise()) : ?>
            <dl>
                <dt> Historisée </dt>
                <dd>
                    <?php echo $applicationElement->getHistoDestruction()->format('d/m/Y à H:i:s'); ?>
                    <br/>
                    <?php echo $applicationElement->getHistoDestructeur()->getDisplayName(); ?>
                </dd>
            </dl>
        <?php endif; ?>
    </div>
</div>
