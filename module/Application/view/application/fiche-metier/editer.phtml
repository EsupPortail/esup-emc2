<?php

use Application\Controller\FicheMetierController;
use FicheMetier\Entity\Db\FicheMetier;
use Application\Entity\Db\ParcoursDeFormation;

/**
 * @see FicheMetierController::editerAction()
 * @var FicheMetier $fiche
 * @var array $competences
 * @var array $applications
 * @var ParcoursDeFormation $parcours
 */

$mode = 'edition-fiche-metier';

$libelle = ($fiche->getMetier())?$fiche->getMetier()->getLibelle():"Aucun libellé";
$this->headTitle('Modification de la fiche métier #' . $fiche->getId(). " : " . $libelle);

echo $this->partial('partial/entete', ['fichemetier' => $fiche, 'mode' => $mode], [], true);

echo $this->messenger()->addMessagesFromFlashMessenger();

echo $this->partial('partial/missions-principales', ['fichemetier' => $fiche, 'missionsprincipales' => $fiche->getActivites(), 'mode' => $mode], [], true);
echo $this->partial('partial/competences', ['fichemetier' => $fiche, 'competences' => $competences, 'mode' => $mode], [], true);
echo $this->partial('partial/applications', ['fichemetier' => $fiche, 'applications' => $applications, 'mode' => $mode], [], true);
//echo $this->partial('partial/parcours-fromations',    ['fichemetier' => $fiche, 'parcours' => $parcours ],                              [], true);

?>

<script>
    $(function () {
        $("body").on("modification", function (event) {
            event.div.modal('hide');
            window.location.reload();
        });
    });
</script>

