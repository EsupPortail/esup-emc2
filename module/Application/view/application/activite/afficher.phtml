<?php

use Application\Entity\Db\Activite;
use Application\Entity\Db\FicheMetierTypeActivite;

/**
 * @see \Application\Controller\ActiviteController::afficherAction()
 * @see \Application\Controller\ActiviteController::modifierAction()
 * @var Activite $activite
 * @var string $mode
 */

$competences    = $activite->getCompetences();
$formations      = $activite->getFormations();

$action = ($mode === 'modifier-activite')?"Modification":"Affichage";
$titre = $action . " de la mission ";
$this->headTitle($titre  . " : " .$activite->getCurrentActiviteLibelle()->getLibelle());
?>

<?php if ($mode === 'modifier-activite') : ?>
    <h1 class="page-header">
        <?php echo $titre; ?> <br/>
        <strong>  <?php echo $activite->getCurrentActiviteLibelle()->getLibelle(); ?> </strong>
    </h1>
<?php endif; ?>

<div class="main">

<?php echo $this->activite($activite, $mode); ?>

<?php
    /** @var FicheMetierTypeActivite[] $ficheMetiers */
    $ficheMetiers = $activite->getFichesMetiers()->toArray();
?>
<h2>
    Fiches métiers associées
    <span class="badge">
        <?php echo  count($ficheMetiers); ?>
    </span>
</h2>

<ul>
    <?php foreach ($ficheMetiers as $ficheMetier) : ?>
        <li> <?php echo $ficheMetier->getFiche()->getMetier()->getLibelle(); ?> </li>
    <?php endforeach; ?>
</ul>
</div>

<script>
    $(function() {
        $("body").on("modification", function (event) {
            event.div.modal('hide');
            tinyMCE.editors=[];
            window.location.reload();
        });
    });
</script>