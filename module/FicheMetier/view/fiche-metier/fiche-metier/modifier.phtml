<?php

use FicheMetier\Entity\Db\FicheMetier;

/**
 * @see \FicheMetier\Controller\FicheMetierController::modifierAction()
 * @var FicheMetier $fiche
 * @var array $competences
 * @var array $competencesSpecifiques
 * @var array $applications
 * @var array $thematiquestypes
 * @var array $thematiqueselements
 */

$mode = 'edition-fiche-metier';

$libelle = ($fiche->getMetier())?$fiche->getMetier()->getLibelle():"Aucun libellé";
$this->headTitle('Modification de la fiche métier #' . $fiche->getId(). " : " . $libelle);

echo $this->partial('partial/entete', ['fichemetier' => $fiche, 'mode' => $mode], [], true);
echo $this->messenger()->addMessagesFromFlashMessenger();
echo $this->partial('partial/missions-principales', ['fichemetier' => $fiche, 'missionsprincipales' => $fiche->getMissions(), 'mode' => $mode], [], true);
echo $this->partial('partial/competences', ['fichemetier' => $fiche, 'competences' => $competences, 'mode' => $mode], [], true);
echo $this->partial('partial/competences', ['fichemetier' => $fiche, 'competences' => $competencesSpecifiques, 'mode' => $mode], [], true);
echo $this->partial('partial/applications', ['fichemetier' => $fiche, 'applications' => $applications, 'mode' => $mode], [], true);


echo $this->partial('partial/thematiques', ['fichemetier' => $fiche, 'thematiquesTypes' => $thematiquestypes, 'thematiquesElements' => $thematiqueselements, 'mode' => $mode], [], true);

?>

<script>
    $(function () {
        $("body").on("modification", function (event) {
            event.div.modal('hide');
            window.location.reload();
        });
    });
</script>

