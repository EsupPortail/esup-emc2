**CHANGES version 3.1.7**
===

Changements
---

* La colonne action des index des modules `Carriere` et `Metier` est maintenant conditionné au fait de pouvoir effectuer au moins une action
* Nouveaux privilèges pour l'affichage des agents à partir des éléments des modules `Carriere` et `Metier`
* Nettoyage du module `Element` 
 

Modification de la base de données
---
* Nouveaux privilèges pour la partie GPEC du module `Carriere`
```postgresql
INSERT INTO unicaen_privilege_privilege(CATEGORIE_ID, CODE, LIBELLE, ORDRE)
WITH d(code, lib, ordre) AS (
    SELECT 'corps_lister_agents', 'Lister les agents', 100
)
SELECT cp.id, d.code, d.lib, d.ordre
FROM d
JOIN unicaen_privilege_categorie cp ON cp.CODE = 'corps';

INSERT INTO unicaen_privilege_privilege(CATEGORIE_ID, CODE, LIBELLE, ORDRE)
WITH d(code, lib, ordre) AS (
    SELECT 'correspondance_lister_agents', 'Lister les agents', 100
)
SELECT cp.id, d.code, d.lib, d.ordre
FROM d
JOIN unicaen_privilege_categorie cp ON cp.CODE = 'correspondance';

INSERT INTO unicaen_privilege_privilege(CATEGORIE_ID, CODE, LIBELLE, ORDRE)
WITH d(code, lib, ordre) AS (
    SELECT 'grade_lister_agents', 'Lister les agents', 100
)
SELECT cp.id, d.code, d.lib, d.ordre
FROM d
JOIN unicaen_privilege_categorie cp ON cp.CODE = 'grade';

-- TODO -- ajuster les privilèges en fonction de votre structure 
```

* Nouveaux privilèges pour la partie GPEC du module `Metier`
```postgresql
INSERT INTO unicaen_privilege_privilege(CATEGORIE_ID, CODE, LIBELLE, ORDRE)
WITH d(code, lib, ordre) AS (
    SELECT 'metier_lister_agents', 'Lister les agents', 110
)
SELECT cp.id, d.code, d.lib, d.ordre
FROM d
JOIN unicaen_privilege_categorie cp ON cp.CODE = 'metier';

-- TODO -- ajuster les privilèges en fonction de votre structure 
```

* Amélioration du module `Element`
```postgresql
alter table element_application_element alter column clef set default false;
update element_application_element set clef=false where clef IS NULL;
alter table element_application_element alter column clef set not null;

update unicaen_privilege_privilege set ordre = 40 where code='application_modifier';
update unicaen_privilege_privilege set ordre = 60 where code='application_effacer';

INSERT INTO unicaen_privilege_privilege(CATEGORIE_ID, CODE, LIBELLE, ORDRE)
WITH d(code, lib, ordre) AS (
    SELECT 'application_ajouter', 'Ajouter', 30 UNION
    SELECT 'application_historiser', 'Historiser/Restaurer', 50 UNION 
    SELECT 'application_cartographie', 'Cartographie des applications', 100
)
SELECT cp.id, d.code, d.lib, d.ordre
FROM d
JOIN unicaen_privilege_categorie cp ON cp.CODE = 'application';

update unicaen_privilege_privilege set ordre = 40 where code='niveau_modifier';
update unicaen_privilege_privilege set ordre = 60 where code='niveau_effacer';

INSERT INTO unicaen_privilege_privilege(CATEGORIE_ID, CODE, LIBELLE, ORDRE)
WITH d(code, lib, ordre) AS (
    SELECT 'niveau_ajouter', 'Ajouter', 30 UNION
    SELECT 'niveau_historiser', 'Historiser/Restaurer', 50
)
SELECT cp.id, d.code, d.lib, d.ordre
FROM d
JOIN unicaen_privilege_categorie cp ON cp.CODE = 'niveau';

-- TODO -- ajuster les privilèges en fonction de votre structure
```